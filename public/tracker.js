!function(){"use strict";const e="navlens-anti-flicker";try{if(!document.getElementById(e)){const t=document.createElement("style");t.id=e,t.textContent="html { visibility: hidden !important; opacity: 0 !important; }",document.head.appendChild(t),setTimeout(()=>{const t=document.getElementById(e);t&&(t.remove(),console.warn("[Navlens] Anti-flicker timed out - showing content"))},500)}}catch(e){}const t=document.currentScript,n=t?.dataset?.apiKey||"",o=t?.dataset?.siteId||"",a=t?.dataset?.apiHost||"https://navlens-rho.vercel.app",i=new URLSearchParams(window.location.search).has("__navlens_editor");i&&console.log("[Navlens] Editor mode detected - tracking disabled"),o||console.warn("[Navlens] Missing data-site-id attribute. Tracker will not work."),n||console.warn("[Navlens] Missing data-api-key attribute. Tracker will not work.");const s=a.includes("://")?a:`https://${a}`,r=`${s}/api/v1/ingest`,c=r,l=`${s}/api/dom-snapshot`,d=`${s}/api/v1/debug-events`,u=`${s}/api/v1/form-events`,p=`${s}/api/feedback`,m=`${s}/api/feedback-config`,f=`${s}/api/v1/batch`,h=`${s}/api/tracker-config`;let g=!0,v=null;try{const e=document.currentScript,t=e?.dataset?.siteId||"",n=e?.dataset?.apiHost||"https://navlens-rho.vercel.app",o=n.includes("://")?n:`https://${n}`;t&&(v=fetch(`${o}/api/tracker-config?siteId=${t}`,{priority:"high",cache:"default"}).then(e=>e.ok?e.json():null).catch(()=>null))}catch(e){}let w={},y=null,b=(new Set,null);function _(e){let t=2166136261;for(let n=0;n<e.length;n++)t^=e.charCodeAt(n),t=Math.imul(t,16777619);return t>>>0}let k=null;async function S(){try{const e=await fetch(`${h}?siteId=${o}`,{priority:"high",cache:"default"});if(e.ok){const t=await e.json();return t.feedback&&(k=t.feedback,console.log("[Navlens] Merged config loaded (experiments + feedback)")),t}}catch(e){console.warn("[navlens] Merged config failed, trying individual:",e.message)}try{const e=await fetch(`${s}/api/experiments/config?siteId=${o}`,{priority:"high",cache:"default"});return e.ok?await e.json():null}catch(e){return console.warn("[navlens] Config fetch failed:",e),null}}function E(e,t){if(e.dataset.nvApplied===t.id)return;const n=t.changes||{};try{switch(t.type){case"css":n.css&&Object.assign(e.style,n.css);break;case"text":void 0!==n.text&&(e.textContent=n.text);break;case"hide":e.style.display="none";break;case"remove":e.remove();break;case"clone":const t=n.cloneCount||1,o=n.clonePosition||"after";for(let n=0;n<t;n++){const t=e.cloneNode(!0);t.removeAttribute("id"),t.removeAttribute("data-nv-applied"),"before"===o?e.parentNode.insertBefore(t,e):e.parentNode.insertBefore(t,e.nextSibling)}break;case"image":if(n.imageUrl){const t=e=>{e.dataset.nvImgUrl!==n.imageUrl&&(e.removeAttribute("srcset"),e.removeAttribute("data-srcset"),e.src=n.imageUrl,e.style.cssText+=`content: url(${n.imageUrl}) !important; object-fit: cover !important;`,e.dataset.nvImgUrl=n.imageUrl)};"IMG"===e.tagName?t(e):e.querySelectorAll("img").forEach(t)}break;case"link":"A"===e.tagName&&(n.linkUrl&&(e.href=n.linkUrl),n.linkTarget&&(e.target=n.linkTarget));break;case"insertHtml":if(n.html){const t=n.html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""),o=n.insertPosition||"after";e.insertAdjacentHTML("before"===o?"beforebegin":"after"===o?"afterend":"prepend"===o?"afterbegin":"beforeend",t)}break;case"replaceHtml":if(n.html){const t=n.html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"");e.outerHTML=t}break;case"resize":n.width&&(e.style.width=n.width),n.height&&(e.style.height=n.height);break;case"dragMove":if(n.targetSelector&&n.position)try{const t=document.querySelector(n.targetSelector);t&&t.parentNode&&("before"===n.position?t.parentNode.insertBefore(e,t):t.parentNode.insertBefore(e,t.nextSibling))}catch(e){console.warn("[navlens] Failed to replay dragMove:",e)}break;case"reorder":if("number"==typeof n.newIndex){const t=e.parentNode,o=Array.from(t.children),a=o[Math.min(n.newIndex,o.length-1)];a&&a!==e&&t.insertBefore(e,a)}break;case"move":n.position&&(e.style.transform=`translate(${n.position.x||0}px, ${n.position.y||0}px)`);break;case"attribute":n.attributes&&Object.entries(n.attributes).forEach(([t,n])=>{t.toLowerCase().startsWith("on")||e.setAttribute(t,n)});break;case"class":n.addClass&&Array.isArray(n.addClass)&&n.addClass.forEach(t=>{t&&"string"==typeof t&&e.classList.add(t)}),n.removeClass&&Array.isArray(n.removeClass)&&n.removeClass.forEach(t=>{t&&"string"==typeof t&&e.classList.remove(t)});break;case"clickRedirect":n.redirectUrl&&(e.style.cursor="pointer",e.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation(),window.location.href=n.redirectUrl},{once:!1}));break;case"tooltip":n.tooltipText&&(e.title=n.tooltipText);break;case"sticky":e.style.position="sticky",e.style.top=n.stickyTop||"0px",e.style.zIndex=n.stickyZIndex||1e3;break;case"placeholder":void 0===n.placeholderText||"INPUT"!==e.tagName&&"TEXTAREA"!==e.tagName||(e.placeholder=n.placeholderText);break;case"formAction":n.formActionUrl&&"FORM"===e.tagName&&(e.action=n.formActionUrl);break;case"animation":if(n.animationName){const t=n.animationDuration||"0.5s";if(!document.getElementById("nv-animation-styles")){const e=document.createElement("style");e.id="nv-animation-styles",e.textContent="\n                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }\n                @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }\n                @keyframes slideInLeft { from { transform: translateX(-100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }\n                @keyframes slideInRight { from { transform: translateX(100%); opacity: 0; } to { transform: translateX(0); opacity: 1; } }\n                @keyframes slideInUp { from { transform: translateY(100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\n                @keyframes slideInDown { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }\n                @keyframes bounce { 0%, 20%, 50%, 80%, 100% { transform: translateY(0); } 40% { transform: translateY(-20px); } 60% { transform: translateY(-10px); } }\n                @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }\n                @keyframes shake { 0%, 100% { transform: translateX(0); } 10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); } 20%, 40%, 60%, 80% { transform: translateX(5px); } }\n              ",document.head.appendChild(e)}if("custom"===n.animationName&&n.animationCustom)e.style.transition=`all ${t}`,n.animationCustom.split(";").forEach(t=>{const[n,o]=t.split(":").map(e=>e.trim());if(n&&o){const t=n.replace(/-([a-z])/g,e=>e[1].toUpperCase());e.style[t]=o}});else{const o=n.animationIteration||"1",a=n.animationDelay||"0s";e.style.animation=`${n.animationName} ${t} ${a} ${o}`}}break;case"html":n.html&&(e.innerHTML=n.html.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""))}e.dataset.nvApplied=t.id}catch(e){console.warn("[navlens] Failed to apply modification:",t.type,e)}}function I(e,t){if(!e?.experiments?.length)return[];const n=[];e.experiments.forEach(e=>{const o=e.v||[];if(!o.length)return;const a=(e.t||100)/100;if(_(`${t}-${e.id}-traffic`)/4294967295>a)return;const i=function(e,t,n){const o=_(`${e}-${t}`),a=o/4294967296;let i=0;for(let e=0;e<n.length;e++)i+=void 0!==n[e].weight?n[e].weight:50;if(i<=0)return o%n.length;let s=a*i,r=0;for(let e=0;e<n.length;e++)if(r+=void 0!==n[e].weight?n[e].weight:50,s<r)return e;return n.length-1}(t,e.id,o),s=o[i];if(s){w[e.id]=s.id;const t=(e.m||[]).filter(e=>e.variant_id===s.id);n.push(...t)}}),window.__NAVLENS_EXPERIMENTS={...w};const o=new Date(Date.now()+2592e6).toUTCString();return document.cookie=`navlens_exp=${encodeURIComponent(JSON.stringify(w))}; expires=${o}; path=/; SameSite=Lax`,n}async function T(){const t=performance.now();let n=document.cookie.match(/navlens_visitor=([^;]+)/)?.[1];if(!n){n="v_"+Math.random().toString(36).substr(2,9);const e=new Date(Date.now()+31536e6).toUTCString();document.cookie=`navlens_visitor=${n}; expires=${e}; path=/; SameSite=Lax`}const o=document.cookie.match(/navlens_exp=([^;]+)/)?.[1];if(o)try{Object.assign(w,JSON.parse(decodeURIComponent(o)))}catch(e){}let a=null;try{const e=localStorage.getItem("navlens_config");if(e){const t=JSON.parse(e);Date.now()-t.timestamp<36e5&&t.data?.feedback?(a=t.data,k=a.feedback,console.log("[Navlens] Using cached merged config")):t.data&&!t.data.feedback&&(localStorage.removeItem("navlens_config"),console.log("[Navlens] Cleared old config cache (upgrading to merged format)"))}}catch(e){}if(a)S().then(e=>{if(e)try{localStorage.setItem("navlens_config",JSON.stringify({data:e,timestamp:Date.now()}))}catch(e){}});else{const e=v||S();a=await Promise.race([e.then(e=>{if(e)try{localStorage.setItem("navlens_config",JSON.stringify({data:e,timestamp:Date.now()})),e.feedback&&(k=e.feedback)}catch(e){}return e}),new Promise(e=>setTimeout(()=>e(null),500))])}if(a){y=a;const e=I(a,n);e.length&&function(e){function t(e){return e.replace(/\.([a-z0-9-]+):([a-z0-9-]+)/gi,".$1\\:$2")}e?.length&&(e.forEach(e=>{try{const n=t(e.selector);document.querySelectorAll(n).forEach(t=>E(t,e))}catch(t){console.warn("[navlens] Invalid selector:",e.selector,t)}}),b&&b.disconnect(),b=new MutationObserver(()=>{e.forEach(e=>{try{const n=t(e.selector);document.querySelectorAll(n).forEach(t=>{t.dataset.nvApplied!==e.id&&E(t,e)})}catch(e){}})}),b.observe(document.documentElement,{childList:!0,subtree:!0}))}(e),setTimeout(()=>{$("pageview",{url:window.location.href,path:window.location.pathname})},100)}const i=document.getElementById(e);i&&i.remove(),"hidden"===document.documentElement.style.visibility&&(document.documentElement.style.visibility="");const s=performance.now()-t;s>100&&console.log(`[navlens] Experiments loaded in ${s.toFixed(0)}ms`)}function x(){return window.__NAVLENS_EXPERIMENTS&&"object"==typeof window.__NAVLENS_EXPERIMENTS&&(w={...w,...window.__NAVLENS_EXPERIMENTS}),w}const C=new Set;function N(e,t,n){if(!t)return!0;const o=e.split("?")[0].split("#")[0].replace(/\/$/,"")||"/",a=t.split("?")[0].split("#")[0].replace(/\/$/,"")||"/";let i=o;try{o.startsWith("http")&&(i=new URL(o).pathname.replace(/\/$/,"")||"/")}catch(e){i=o.replace(/^https?:\/\/[^\/]+/,"").replace(/\/$/,"")||"/"}switch(n){case"exact":return i===a||o===a;case"contains":return i.includes(t)||o.includes(t);case"regex":try{return new RegExp(t).test(i)||new RegExp(t).test(e)}catch{return!1}default:return i.includes(t)}}function L(e,t,n){switch(e.type){case"click":if("click"!==t)return!1;if(e.selector&&n.element)try{return n.element.matches(e.selector)||null!==n.element.closest(e.selector)}catch{return!1}return e.url_pattern?N(window.location.href,e.url_pattern,e.url_match||"contains"):!e.selector;case"pageview":if("pageview"!==t)return!1;const o=N(window.location.href,e.url_pattern,e.url_match||"contains");return o;case"form_submit":if("form_submit"!==t&&"submit"!==t)return!1;if(e.selector&&n.element)try{return n.element.matches(e.selector)||null!==n.element.closest(e.selector)}catch{return!1}return!0;case"custom_event":case"revenue":return t===e.event_name;case"scroll_depth":if("scroll_depth"!==t)return!1;const a=e.depth_percentage||50;return(n.depth||0)>=a;case"time_on_page":if("time_threshold"!==t)return!1;const i=e.seconds||30;return(n.seconds||0)>=i;default:return!1}}function A(e,t,n,o){const a=`${e}:${n.id}`;if(C.has(a))return;C.add(a);const i={event_type:"experiment_goal",experiment_id:e,variant_id:t,goal_id:n.id,goal_type:n.type,goal_name:n.name,is_primary:n.is_primary,timestamp:Date.now(),page_path:window.location.pathname};if("revenue"===n.type&&n.track_value&&n.value_field){const e=o.properties?.[n.value_field]||o[n.value_field];"number"==typeof e&&(i.revenue_value=e,i.currency=n.currency||"USD")}F(c,i)}function $(e,t){if(y?.experiments)for(const n of y.experiments){const o=w[n.id];if(!o)continue;const a=n.g||n.goal_event,i=n.goals||(a?[{id:"legacy_goal",name:a,type:"custom_event",event_name:a,is_primary:!0}]:[]);for(const a of i)L(a,e,t)&&A(n.id,o,a,t)}}document.addEventListener("DOMContentLoaded",()=>{setTimeout(()=>{$("pageview",{})},100)});const M=[25,50,75,90,100];let D=new Set;window.addEventListener("scroll",()=>{const e=document.documentElement.scrollHeight-window.innerHeight;if(e<=0)return;const t=Math.round(window.scrollY/e*100);if(t>Ze){Ze=t;for(const e of M)t>=e&&!D.has(e)&&(D.add(e),$("scroll_depth",{depth:e}))}},{passive:!0});let O=Date.now();const P=[15,30,60,120,300];let j=new Set;setInterval(()=>{const e=Math.floor((Date.now()-O)/1e3);for(const t of P)e>=t&&!j.has(t)&&(j.add(t),$("time_threshold",{seconds:t}))},5e3),document.addEventListener("click",e=>{const t=e.target;var n;t&&(n=t,!n.closest?.("[data-navlens-ignore]"))&&$("click",{element:t,selector:t.tagName?.toLowerCase()})},!0),document.addEventListener("submit",e=>{const t=e.target;t&&$("form_submit",{element:t,formId:t.id,formAction:t.action})},!0);const R=history.pushState,U=history.replaceState;function H(){setTimeout(()=>{if($("pageview",{url:window.location.href,path:window.location.pathname}),window.navlens&&window.navlens.getExperiments){window.navlens.getExperiments()}},100)}history.pushState=function(){R.apply(this,arguments),H()},history.replaceState=function(){U.apply(this,arguments),H()},window.addEventListener("popstate",H),window.navlens=window.navlens||{},window.navlens.setExperiment=function(e,t){w[e]=t,window.__NAVLENS_EXPERIMENTS={...x()}},window.navlens.getExperiments=x,window.navlens.reloadExperiments=T,window.navlens.track=function(e,t={}){$(e,{properties:t}),F(c,{event_type:e,properties:t,timestamp:Date.now(),page_path:window.location.pathname})},window.navlens.trackRevenue=function(e,t,n={}){$(e,{properties:{...n,amount:t,value:t},amount:t}),F(c,{event_type:e,revenue:t,properties:n,timestamp:Date.now(),page_path:window.location.pathname})};T();if(new URLSearchParams(window.location.search).has("__navlens_editor")){const e=document.createElement("script");e.src=`${s}/ab-editor.js`,e.async=!0,document.head.appendChild(e)}function B(e){const t={...e};t.event_type&&(t.type=t.event_type,delete t.event_type),t.timestamp||(t.timestamp=(new Date).toISOString()),t.session_id||(t.session_id=Ue);const a=t.device_info||qe(),i={type:t.type,timestamp:t.timestamp,session_id:t.session_id,user_id:t.user_id||null,page_url:t.page_url||window.location.href,page_path:t.page_path||window.location.pathname,referrer:t.referrer||document.referrer||"",user_agent:a.user_agent||navigator.userAgent,user_language:a.language||navigator.language,viewport_width:a.viewport_width||window.innerWidth,viewport_height:a.viewport_height||window.innerHeight,screen_width:a.screen_width||screen.width,screen_height:a.screen_height||screen.height,device_type:a.device_type||Fe(),client_id:t.client_id||n,load_time:t.load_time||0,experiment_ids:Object.keys(x()),variant_ids:Object.values(x()),data:{event_id:t.event_id,element_selector:t.element_selector,element_tag:t.element_tag,element_id:t.element_id,element_classes:t.element_class,element_text:t.element_text,element_href:t.element_href,x:t.x,y:t.y,click_x:t.click_x,click_y:t.click_y,page_x:t.page_x,page_y:t.page_y,x_relative:t.x_relative,y_relative:t.y_relative,document_width:t.document_width,document_height:t.document_height,element_position:t.element_position,is_interactive:t.is_interactive,is_dead_click:t.is_dead_click,scroll_depth:t.scroll_depth,max_scroll_depth:t.max_scroll_depth,click_count:t.click_count,visible_time_ms:t.visible_time_ms,total_visible_time_ms:t.total_visible_time_ms,page_title:t.page_title,event_name:t.event_name,properties:t.properties,traits:t.traits}};return Object.keys(i.data).forEach(e=>{void 0===i.data[e]&&delete i.data[e]}),{events:[i],siteId:o}}function F(e,t){const n=B(t),o=new Blob([JSON.stringify(n)],{type:"application/json"});return navigator.sendBeacon?navigator.sendBeacon(e,o):(fetch(e,{method:"POST",body:o,keepalive:!0}).catch(console.error),!0)}async function q(e,t){return ae(e,B(t))}const X="navlens_session",z="navlens_visitor";let W=null;const V=[];let Y=!1;function J(e,t="idle"){return new Promise((n,o)=>{const a={task:e,priority:t,resolve:n,reject:o,timestamp:Date.now()};"high"===t?V.unshift(a):V.push(a),Y||function(){if(0===V.length)return void(Y=!1);Y=!0;const e=t=>{for(;V.length>0&&(t?.timeRemaining?.()>0||!t);){const e=performance.now(),t=V.shift();try{const e=t.task();e instanceof Promise?e.then(t.resolve).catch(t.reject):t.resolve(e)}catch(e){t.reject(e)}if(performance.now()-e>16)break}V.length>0?"undefined"!=typeof requestIdleCallback?requestIdleCallback(e,{timeout:100}):setTimeout(()=>e(null),0):Y=!1};"undefined"!=typeof requestIdleCallback?requestIdleCallback(e,{timeout:100}):setTimeout(()=>e(null),0)}()})}async function G(e){const t="string"==typeof e?e:JSON.stringify(e),n=(new TextEncoder).encode(t);if("undefined"==typeof CompressionStream)return new Blob([n],{type:"application/json"});try{const e=new ReadableStream({start(e){e.enqueue(n),e.close()}}),t=e.pipeThrough(new CompressionStream("gzip")).getReader(),o=[];for(;;){const{done:e,value:n}=await t.read();if(e)break;o.push(n)}const a=o.reduce((e,t)=>e+t.length,0),i=new Uint8Array(a);let s=0;for(const e of o)i.set(e,s),s+=e.length;return new Blob([i],{type:"application/gzip"})}catch(e){return console.warn("[Navlens] Compression failed, sending uncompressed:",e),new Blob([n],{type:"application/json"})}}const Z=[],K=3,Q=5e3;let ee=null;function te(e,t,n=0){n>=K?console.warn("[Navlens] Max retries reached, dropping event"):(Z.push({url:e,payload:t,retryCount:n}),ne())}function ne(){ee||(ee=setTimeout(oe,Q))}async function oe(){if(ee=null,0===Z.length)return;const e=Z.splice(0,5);for(const t of e)try{await ae(t.url,t.payload,!1)}catch(e){te(t.url,t.payload,t.retryCount+1)}Z.length>0&&ne()}async function ae(e,t,o=!0){const a=await G(t),i="application/gzip"===a.type,s={"x-api-key":n};i?(s["Content-Encoding"]="gzip",s["Content-Type"]="application/json"):s["Content-Type"]="application/json";const r=(a.size||0)<6e4;try{const t=await fetch(e,{method:"POST",headers:s,body:a,keepalive:r});if(!t.ok&&o)throw new Error(`HTTP ${t.status}`);return t}catch(n){throw o&&te(e,t),n}}const ie={email:{pattern:/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g,replacement:"[EMAIL_REDACTED]"},phone:{pattern:/(?:\+?1[-.\s]?)?(?:\(?[0-9]{3}\)?[-.\s]?)?[0-9]{3}[-.\s]?[0-9]{4}/g,replacement:"[PHONE_REDACTED]"},creditCard:{pattern:/(?:4[0-9]{12}(?:[0-9]{3})?|5[1-5][0-9]{14}|3[47][0-9]{13}|6(?:011|5[0-9]{2})[0-9]{12})/g,replacement:"[CC_REDACTED]"},ssn:{pattern:/\b\d{3}[-.\s]?\d{2}[-.\s]?\d{4}\b/g,replacement:"[SSN_REDACTED]"},ipAddress:{pattern:/\b(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\b/g,replacement:"[IP_REDACTED]"}};function se(e){if("string"!=typeof e)return e;let t=e;for(const[e,n]of Object.entries(ie))t=t.replace(n.pattern,n.replacement);return t}function re(e,t=0){if(t>10)return e;if(null==e)return e;if("string"==typeof e)return se(e);if(Array.isArray(e))return e.map(e=>re(e,t+1));if("object"==typeof e){const n={};for(const[o,a]of Object.entries(e))n[o]=re(a,t+1);return n}return e}const ce=[];let le=0,de=0,ue=null,pe=!1;function me(e){ce.push({...e,timestamp:(new Date).toISOString(),page_url:window.location.href,page_path:window.location.pathname}),ce.length>=10?fe():ue||(ue=setTimeout(fe,2e3))}async function fe(){if(ue&&(clearTimeout(ue),ue=null),0===ce.length)return;const e=ce.splice(0,ce.length);try{await ae(d,{events:e,siteId:o,sessionId:Ue},!1)}catch(e){console.warn("[Navlens] Debug event send failed:",e.message)}}setInterval(async function(){const e=ce.splice(0,ce.length),t=void 0!==Ee?Ee.splice(0,Ee.length):[];if(0!==e.length||0!==t.length){if(ue&&(clearTimeout(ue),ue=null),void 0!==Ie&&Ie&&(clearTimeout(Ie),Ie=null),g)try{return void await ae(f,{siteId:o,sessionId:Ue,batch:{debug:e.length>0?e:void 0,forms:t.length>0?t:void 0}},!1)}catch(e){console.warn("[Navlens] Batch send failed, falling back to individual:",e.message),g=!1}e.length>0&&ae(d,{events:e,siteId:o,sessionId:Ue},!1).catch(()=>{}),t.length>0&&ae(u,{events:t,siteId:o,sessionId:Ue},!1).catch(()=>{})}},3e3);const he={log:console.log,warn:console.warn,error:console.error,info:console.info,debug:console.debug};function ge(){try{throw new Error}catch(e){return(e.stack||"").split("\n").slice(3).join("\n").substring(0,2e3)}}["log","warn","error","info","debug"].forEach(function(e){console[e]=function(...t){if(he[e].apply(console,t),le>=100)return;const n=t.map(e=>{try{return"object"==typeof e?JSON.stringify(e):String(e)}catch{return"[Unserializable]"}}).join(" ");n.includes("[Navlens]")||(le++,me({type:"console",level:e,message:se(n.substring(0,5e3)),stack:"error"===e?ge():""}))}}),window.addEventListener("error",function(e){le>=100||(le++,me({type:"console",level:"error",message:se(`Uncaught: ${e.message}`),stack:e.error?.stack?se(e.error.stack.substring(0,2e3)):""}))}),window.addEventListener("unhandledrejection",function(e){if(le>=100)return;le++;const t=e.reason;me({type:"console",level:"error",message:se(`Unhandled Promise: ${t?.message||String(t)}`),stack:t?.stack?se(t.stack.substring(0,2e3)):""})});const ve=["/api/v1/ingest","/api/v1/debug-events","/api/rrweb-events","/api/dom-snapshot","navlens"];function we(e){return!(!e||"string"!=typeof e)&&ve.some(t=>e.includes(t))}function ye(e){try{const t=new URL(e,window.location.origin);return["token","key","password","secret","auth","api_key","apikey","access_token"].forEach(e=>{t.searchParams.has(e)&&t.searchParams.set(e,"[REDACTED]")}),t.toString()}catch{return se(String(e))}}const be=window.fetch;window.fetch=async function(e,t){let n;if(n="string"==typeof e?e:e instanceof URL?e.toString():"object"==typeof e&&null!==e&&"url"in e?e.url:String(e),n&&we(n))return be.apply(this,arguments);const o=performance.now(),a=t?.method||"GET";try{const e=await be.apply(this,arguments),t=Math.round(performance.now()-o);return de<200&&(de++,me({type:"network",method:a.toUpperCase(),url:ye(n),status:e.status,duration_ms:t,network_type:"fetch",initiator:"script"})),e}catch(e){const t=Math.round(performance.now()-o);throw de<200&&(de++,me({type:"network",method:a.toUpperCase(),url:ye(n),status:0,duration_ms:t,network_type:"fetch",initiator:"script"})),e}};const _e=XMLHttpRequest.prototype.open,ke=XMLHttpRequest.prototype.send;function Se(e,t){const[n,o]={LCP:[2500,4e3],FID:[100,300],CLS:[.1,.25],INP:[200,500],FCP:[1800,3e3],TTFB:[800,1800]}[e]||[1/0,1/0];return t<=n?"good":t<=o?"needs-improvement":"poor"}XMLHttpRequest.prototype.open=function(e,t){return this._navlens_method=e,this._navlens_url=t,this._navlens_start=null,_e.apply(this,arguments)},XMLHttpRequest.prototype.send=function(){const e=this._navlens_url;if(we(e))return ke.apply(this,arguments);this._navlens_start=performance.now();const t=this._navlens_method||"GET";return this.addEventListener("loadend",()=>{if(de>=200)return;const n=Math.round(performance.now()-this._navlens_start);de++,me({type:"network",method:t.toUpperCase(),url:ye(e),status:this.status,duration_ms:n,network_type:"xhr",initiator:"script"})}),ke.apply(this,arguments)},function(){if("undefined"!=typeof PerformanceObserver){try{new PerformanceObserver(e=>{const t=e.getEntries(),n=t[t.length-1];n&&me({type:"web_vital",vital_name:"LCP",vital_value:Math.round(n.startTime),vital_rating:Se("LCP",n.startTime)})}).observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}try{new PerformanceObserver(e=>{const t=e.getEntries().find(e=>"first-contentful-paint"===e.name);t&&me({type:"web_vital",vital_name:"FCP",vital_value:Math.round(t.startTime),vital_rating:Se("FCP",t.startTime)})}).observe({type:"paint",buffered:!0})}catch(e){}try{let e=0;new PerformanceObserver(t=>{for(const n of t.getEntries())n.hadRecentInput||(e+=n.value)}).observe({type:"layout-shift",buffered:!0}),document.addEventListener("visibilitychange",()=>{"hidden"!==document.visibilityState||pe||me({type:"web_vital",vital_name:"CLS",vital_value:Math.round(1e3*e)/1e3,vital_rating:Se("CLS",e)})})}catch(e){}try{let e=0;new PerformanceObserver(t=>{for(const n of t.getEntries()){const t=n.processingEnd-n.startTime;t>e&&(e=t)}}).observe({type:"event",buffered:!0}),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&e>0&&!pe&&(me({type:"web_vital",vital_name:"INP",vital_value:Math.round(e),vital_rating:Se("INP",e)}),pe=!0,fe())})}catch(e){}try{const e=performance.getEntriesByType("navigation")[0];if(e){const t=e.responseStart-e.requestStart;me({type:"web_vital",vital_name:"TTFB",vital_value:Math.round(t),vital_rating:Se("TTFB",t)})}}catch(e){}}}(),window.addEventListener("beforeunload",fe),window.addEventListener("pagehide",fe);const Ee=[];let Ie=null;const Te=new Map,xe=new Map,Ce=[/password/i,/ssn/i,/social.*security/i,/credit.*card/i,/card.*number/i,/cvv/i,/cvc/i,/pin/i,/secret/i];function Ne(e){if("password"===e.type)return!0;const t=(e.name||"")+(e.id||"");return Ce.some(e=>e.test(t))}function Le(e){if(e.id)return`id:${e.id}`;if(e.name)return`name:${e.name}`;return`form:${Array.from(document.forms).indexOf(e)}`}function Ae(e){if(e.id)return e.id;if(e.name)return e.name;const t=e.form;if(t){const n=Array.from(t.elements).filter(t=>t.type===e.type).indexOf(e);return`${e.type}_${n}`}return`field_${Math.random().toString(36).substr(2,9)}`}function $e(e){const t=e.form;if(!t)return 0;return Array.from(t.elements).filter(e=>["input","select","textarea"].includes(e.tagName.toLowerCase())&&!["hidden","submit","button","reset"].includes(e.type)).indexOf(e)+1}function Me(e){Ee.push({...e,timestamp:(new Date).toISOString()}),Ee.length>=10?De():Ie||(Ie=setTimeout(De,3e3))}async function De(){if(Ie&&(clearTimeout(Ie),Ie=null),0===Ee.length)return;const e=Ee.splice(0,Ee.length);try{await ae(u,{events:e,siteId:o,sessionId:Ue},!1)}catch(e){}}function Oe(e){const t=Le(e.target),n=xe.get(t);n&&(n.hasSubmitted=!0,Me({form_id:t,form_url:window.location.href,field_id:"",field_name:"",field_type:"",field_index:0,interaction_type:"submit",was_submitted:!0}),De())}function Pe(){xe.forEach((e,t)=>{!e.hasSubmitted&&e.fields.size>0&&Me({form_id:t,form_url:window.location.href,field_id:"",field_name:"",field_type:"",field_index:0,interaction_type:"abandon",was_submitted:!1})}),De()}function je(){return"sess_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+"_"+Date.now()}function Re(){return"evt_"+Math.random().toString(36).substring(2,15)+"_"+Date.now()}document.addEventListener("focusin",e=>{e.target.tagName&&["INPUT","SELECT","TEXTAREA"].includes(e.target.tagName)&&function(e){const t=e.target;if(!t.form||Ne(t))return;const n=Ae(t),o=Le(t.form),a=Date.now();Te.set(n,{focusTime:a,changeCount:0,lastValueLength:(t.value||"").length,wasRefilled:!1}),xe.has(o)||xe.set(o,{fields:new Set,hasSubmitted:!1}),xe.get(o).fields.add(n),Me({form_id:o,form_url:window.location.href,field_id:n,field_name:t.name||"",field_type:t.type||"text",field_index:$e(t),interaction_type:"focus",focus_time:new Date(a).toISOString()})}(e)},!0),document.addEventListener("focusout",e=>{e.target.tagName&&["INPUT","SELECT","TEXTAREA"].includes(e.target.tagName)&&function(e){const t=e.target;if(!t.form||Ne(t))return;const n=Ae(t),o=Le(t.form),a=Te.get(n),i=Date.now();if(a){const e=i-a.focusTime,s=(t.value||"").length>0;Me({form_id:o,form_url:window.location.href,field_id:n,field_name:t.name||"",field_type:t.type||"text",field_index:$e(t),interaction_type:"blur",focus_time:new Date(a.focusTime).toISOString(),blur_time:new Date(i).toISOString(),time_spent_ms:Math.min(e,36e5),change_count:a.changeCount,was_refilled:a.wasRefilled,field_had_value:s}),Te.delete(n)}}(e)},!0),document.addEventListener("input",e=>{e.target.tagName&&["INPUT","SELECT","TEXTAREA"].includes(e.target.tagName)&&function(e){const t=e.target;if(!t.form||Ne(t))return;const n=Ae(t),o=Te.get(n);if(o){o.changeCount++;const e=(t.value||"").length,n=o.lastValueLength;n>0&&e<.5*n?o.deletedContent=!0:o.deletedContent&&e>n&&(o.wasRefilled=!0,o.deletedContent=!1),o.lastValueLength=e}}(e)},!0),document.addEventListener("submit",Oe,!0),window.addEventListener("beforeunload",Pe),window.addEventListener("pagehide",Pe),document.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&Pe()});let Ue=function(){try{const e=localStorage.getItem(X);if(e){const t=JSON.parse(e),n=Date.now();if(n-t.lastActivity<18e5)return t.lastActivity=n,localStorage.setItem(X,JSON.stringify(t)),t.id}}catch(e){}const e={id:je(),createdAt:Date.now(),lastActivity:Date.now()};return localStorage.setItem(X,JSON.stringify(e)),e.id}(),He=function(){try{const e=localStorage.getItem(z);if(e)return e}catch(e){}const e="vis_"+Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)+"_"+Date.now();try{localStorage.setItem(z,e)}catch(e){}return e}();function Be(){const e=navigator.userAgent;let t="Unknown";return e.includes("Firefox/")?t="Firefox":e.includes("Edg/")?t="Edge":e.includes("Chrome/")?t="Chrome":e.includes("Safari/")&&!e.includes("Chrome")?t="Safari":(e.includes("MSIE")||e.includes("Trident/"))&&(t="IE"),t}function Fe(){const e=window.innerWidth;return e<768?"mobile":e<1024?"tablet":"desktop"}function qe(){return{browser:Be(),device_type:Fe(),screen_width:window.screen.width,screen_height:window.screen.height,viewport_width:window.innerWidth,viewport_height:window.innerHeight,user_agent:navigator.userAgent,language:navigator.language,platform:navigator.platform}}function Xe(){return{width:Math.max(document.body.scrollWidth,document.documentElement.scrollWidth,document.body.offsetWidth,document.documentElement.offsetWidth,document.body.clientWidth,document.documentElement.clientWidth),height:Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)}}function ze(){try{const e=document.body;if(!e)return null;const t=e.querySelectorAll("*");let n="";const o=Math.max(1,Math.floor(t.length/500));for(let e=0;e<t.length;e+=o){const o=t[e];if(n+=o.tagName,o.id&&(n+="#"+o.id),o.className&&"string"==typeof o.className){const e=o.className.trim().split(/\s+/).slice(0,2).join(".");e&&(n+="."+e)}n+="|"}const a=Xe();n+=`D:${a.width}x${a.height}`;let i=5381;for(let e=0;e<n.length;e++)i=(i<<5)+i+n.charCodeAt(e),i&=i;return i.toString(36)}catch(e){return console.warn("[Navlens] DOM hash generation failed:",e),null}}async function We(){const e=ze();e&&W&&e!==W&&(console.log("[Navlens] DOM structure changed, capturing new snapshot"),J(async()=>{const t=await Je();t&&(t.hash=e,t.previous_hash=W,await Ge(t))},"idle")),W=e}let Ve=!1;function Ye(e){return new Promise((t,n)=>{if(document.querySelector(`script[src="${e}"]`))return void t();const o=document.createElement("script");o.src=e,o.onload=t,o.onerror=n,document.head.appendChild(o)})}async function Je(e=null){return J(async()=>{if(void 0===window.rrwebSnapshot||!window.rrwebSnapshot?.snapshot)try{console.log("[Navlens] Loading rrweb-snapshot..."),await Ye("https://cdn.jsdelivr.net/npm/rrweb-snapshot@latest/dist/rrweb-snapshot.min.js")}catch(e){return console.warn("[Navlens] Failed to load rrweb-snapshot"),null}if(void 0===window.rrwebSnapshot||!window.rrwebSnapshot?.snapshot)return console.warn("[Navlens] rrweb-snapshot still not loaded after attempt"),null;try{const t=window.rrwebSnapshot.snapshot(document);return{site_id:o,page_path:window.location.pathname,device_type:e?e.name:Fe(),snapshot:re(t),width:e?e.width:window.innerWidth,height:e?e.height:window.innerHeight,origin:window.location.origin,timestamp:(new Date).toISOString()}}catch(e){return console.error("[Navlens] Snapshot capture failed:",e),null}},"normal")}async function Ge(e){if(e)try{await ae(l,e),console.log("[Navlens] Snapshot sent successfully")}catch(e){console.error("[Navlens] Failed to send snapshot:",e)}}let Ze=0;window.scrollY;new Map;Date.now();Date.now();let Ke=0;window.Navlens={version:"7.0.0",sessionId:Ue,track:(e,t={})=>{const n={event_type:"custom",event_name:e,event_id:Re(),session_id:Ue,timestamp:(new Date).toISOString(),page_url:window.location.href,page_path:window.location.pathname,properties:re(t),device_info:qe()};q(r,n).catch(console.error)},identify:(e,t={})=>{const n={event_type:"identify",event_id:Re(),session_id:Ue,timestamp:(new Date).toISOString(),page_url:window.location.href,page_path:window.location.pathname,user_id:se(String(e)),traits:re(t),device_info:qe()};q(r,n).catch(console.error)},captureSnapshot:async()=>{const e=await Je();return e&&(e.hash=ze(),await Ge(e)),e},getSession:()=>({sessionId:Ue,scrollDepth:Ze,isRecording:Ve,totalVisibleTime:Ke,domHash:W}),refreshSession:()=>{Ue=je();const e={id:Ue,createdAt:Date.now(),lastActivity:Date.now()};return localStorage.setItem(X,JSON.stringify(e)),window.Navlens.sessionId=Ue,Ue},checkDomChanges:()=>{We()},getDomHash:()=>ze(),getSessionId:()=>Ue,getVisitorId:()=>He,setContext:(e={})=>{"object"==typeof e&&(window.__navlens_context={...window.__navlens_context||{},...e})},scrubPII:se,scrubObjectPII:re},window.navlens=window.Navlens;let Qe={enabled:!0,position:"bottom-right",primaryColor:"#3B82F6",showOnScroll:50,showAfterTime:3e4,allowDismiss:!0,collectIntent:!0,collectIssues:!0,showExitIntent:!0,showFrustrationSurvey:!0};const et=[{value:1,emoji:"üò°",label:"Very Bad"},{value:2,emoji:"üòû",label:"Bad"},{value:3,emoji:"üòê",label:"Okay"},{value:4,emoji:"üòä",label:"Good"},{value:5,emoji:"üòç",label:"Excellent"}],tt=[{code:"cant_find",label:"Couldn't find what I need",icon:"üîç"},{code:"confusing",label:"Confusing navigation",icon:"üß≠"},{code:"slow",label:"Page too slow",icon:"‚è≥"},{code:"broken",label:"Something broken",icon:"üîß"},{code:"pricing",label:"Pricing unclear",icon:"üí∞"},{code:"other",label:"Other issue",icon:"‚ùì"}],nt=[{code:"buy",label:"Buy",icon:"üõí"},{code:"learn",label:"Learn",icon:"üìö"},{code:"compare",label:"Compare",icon:"‚öñÔ∏è"},{code:"support",label:"Get Help",icon:"üí¨"},{code:"browse",label:"Just Browsing",icon:"üëÄ"}];let ot=null,at=!1,it=!1,st=!1;function rt(){const e=document.createElement("button");e.className=`navlens-feedback-btn ${Qe.position}`,e.style.backgroundColor=Qe.primaryColor,e.innerHTML='\n      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n        <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>\n      </svg>\n      <span>Feedback</span>\n    ',e.onclick=ct,document.body.appendChild(e),ot=e}function ct(){if(at)return;at=!0,ot&&ot.classList.add("navlens-hidden");const e=document.createElement("div");e.id="navlens-feedback-modal",e.className="navlens-feedback-modal";let t="rating",n=null,a=[],i=null,s="";e.innerHTML=`\n      <div class="navlens-feedback-backdrop"></div>\n      <div class="navlens-feedback-content">\n        <div class="navlens-feedback-header">\n          <h2 class="navlens-feedback-title">Share Your Feedback</h2>\n          <button class="navlens-feedback-close">\n            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">\n              <path d="M18 6L6 18M6 6l12 12"></path>\n            </svg>\n          </button>\n        </div>\n        <div class="navlens-feedback-body"></div>\n        ${Qe.allowDismiss?'\n        <div class="navlens-footer">\n          <button class="navlens-dismiss-btn">Don\'t show again on this page</button>\n        </div>\n        ':""}\n      </div>\n    `,document.body.appendChild(e),e.querySelector(".navlens-feedback-backdrop").onclick=lt,e.querySelector(".navlens-feedback-close").onclick=lt,Qe.allowDismiss&&(e.querySelector(".navlens-dismiss-btn").onclick=()=>{it=!0,sessionStorage.setItem("navlens_feedback_dismissed","true"),lt()}),function r(){const c=e.querySelector(".navlens-feedback-body");if(c)if("rating"===t)c.innerHTML=`\n          <p class="navlens-feedback-step-title">How would you rate your experience?</p>\n          <div class="navlens-rating-group">\n            ${et.map(e=>`\n              <button class="navlens-rating-btn ${n===e.value?"selected":""}" \n                      data-rating="${e.value}" title="${e.label}">\n                ${e.emoji}\n              </button>\n            `).join("")}\n          </div>\n        `,c.querySelectorAll(".navlens-rating-btn").forEach(e=>{e.onclick=()=>{n=parseInt(e.dataset.rating),t=Qe.collectIssues&&n<=3?"issues":Qe.collectIntent?"intent":"message",r()}});else if("issues"===t)c.innerHTML=`\n          <p class="navlens-feedback-step-title">What went wrong?</p>\n          <div class="navlens-options-grid">\n            ${tt.map(e=>`\n              <button class="navlens-option-btn ${a.includes(e.code)?"selected":""}" \n                      data-issue="${e.code}">\n                <span class="navlens-option-icon">${e.icon}</span>\n                <span>${e.label}</span>\n              </button>\n            `).join("")}\n          </div>\n          <button class="navlens-submit-btn" ${0===a.length?"disabled":""}>Continue</button>\n          <button class="navlens-skip-btn">Skip</button>\n        `,c.querySelectorAll(".navlens-option-btn").forEach(e=>{e.onclick=()=>{const t=e.dataset.issue;a.includes(t)?a=a.filter(e=>e!==t):a.push(t),r()}}),c.querySelector(".navlens-submit-btn").onclick=()=>{t=Qe.collectIntent?"intent":"message",r()},c.querySelector(".navlens-skip-btn").onclick=()=>{t=Qe.collectIntent?"intent":"message",r()};else if("intent"===t)c.innerHTML=`\n          <p class="navlens-feedback-step-title">What brought you here today?</p>\n          <div class="navlens-options-grid">\n            ${nt.map(e=>`\n              <button class="navlens-option-btn ${i===e.code?"selected":""}" \n                      data-intent="${e.code}">\n                <span class="navlens-option-icon">${e.icon}</span>\n                <span>${e.label}</span>\n              </button>\n            `).join("")}\n          </div>\n          <button class="navlens-submit-btn" ${i?"":"disabled"}>Continue</button>\n          <button class="navlens-skip-btn">Skip</button>\n        `,c.querySelectorAll(".navlens-option-btn").forEach(e=>{e.onclick=()=>{i=e.dataset.intent,r()}}),c.querySelector(".navlens-submit-btn").onclick=()=>{t="message",r()},c.querySelector(".navlens-skip-btn").onclick=()=>{t="message",r()};else if("message"===t){c.innerHTML='\n          <p class="navlens-feedback-step-title">Any additional feedback? (optional)</p>\n          <textarea class="navlens-textarea" rows="4" placeholder="Tell us more about your experience..."></textarea>\n          <button class="navlens-submit-btn">Submit Feedback</button>\n        ';c.querySelector(".navlens-textarea").oninput=e=>{s=e.target.value},c.querySelector(".navlens-submit-btn").onclick=async e=>{const c=e.target,l=c.textContent;c.textContent="Sending...",c.disabled=!0,c.style.opacity="0.7",c.style.cursor="wait";await async function(e){const t={siteId:o,sessionId:Ue,rating:e.selectedRating,intent:e.selectedIntent,issues:e.selectedIssues,message:se(e.feedbackMessage||""),pagePath:window.location.pathname,pageUrl:window.location.href,deviceType:Fe(),userAgent:navigator.userAgent,surveyType:"manual",timestamp:(new Date).toISOString()};try{return await ae(p,t,!1),console.log("[Navlens] Feedback submitted successfully"),!0}catch(e){return console.warn("[Navlens] Failed to submit feedback:",e.message),!1}}({selectedRating:n,selectedIssues:a,selectedIntent:i,feedbackMessage:s})?(t="success",r()):(c.textContent="Failed. Try Again",c.disabled=!1,c.style.opacity="1",c.style.cursor="pointer",setTimeout(()=>{c.textContent=l},3e3))}}else"success"===t&&(st=!0,c.innerHTML='\n          <div class="navlens-success">\n            <div class="navlens-success-icon">üéâ</div>\n            <h3 class="navlens-success-title">Thank You!</h3>\n            <p class="navlens-success-text">Your feedback helps us improve.</p>\n          </div>\n        ',setTimeout(()=>{lt()},2e3))}()}function lt(){const e=document.getElementById("navlens-feedback-modal");e&&e.remove(),at=!1,!ot||it||st||ot.classList.remove("navlens-hidden")}async function dt(){if(await async function(){if(o){if(k)return Qe={...Qe,enabled:k.enabled??!0,position:k.position||"bottom-right",primaryColor:k.primaryColor||"#3B82F6",allowDismiss:k.allowDismiss??!0,showExitIntent:k.showExitIntent??!0,showFrustrationSurvey:k.showFrustrationSurvey??!0,showAfterTime:1e3*(k.minTimeBeforeSurvey||30),showOnScroll:k.showOnScroll||50,collectIntent:k.collectIntent??!0,collectIssues:k.collectIssues??!0},void console.log("[Navlens] Feedback config loaded from merged endpoint");try{const e=await fetch(`${m}?siteId=${o}`,{method:"GET",headers:{Accept:"application/json"}});if(e.ok){const t=await e.json();t.config&&(Qe={...Qe,enabled:t.config.enabled??!0,position:t.config.position||"bottom-right",primaryColor:t.config.primaryColor||"#3B82F6",allowDismiss:t.config.allowDismiss??!0,showExitIntent:t.config.showExitIntent??!0,showFrustrationSurvey:t.config.showFrustrationSurvey??!0,showAfterTime:1e3*(t.config.minTimeBeforeSurvey||30),showOnScroll:t.config.showOnScroll||50,collectIntent:t.config.collectIntent??!0,collectIssues:t.config.collectIssues??!0},console.log("[Navlens] Feedback config loaded from dashboard"))}}catch(e){console.warn("[Navlens] Failed to fetch feedback config, using defaults:",e.message)}}}(),!Qe.enabled)return;if("true"===sessionStorage.getItem("navlens_feedback_dismissed"))return void(it=!0);!function(){if(document.getElementById("navlens-feedback-styles"))return;const e=document.createElement("link");e.id="navlens-feedback-styles",e.rel="stylesheet",e.href=`${s}/navlens-feedback.css`,document.head.appendChild(e)}();const e=()=>{ot&&(ot.style.backgroundColor=Qe.primaryColor)};let t=!1;setTimeout(()=>{ot||it||st||(rt(),e())},Qe.showAfterTime),window.addEventListener("scroll",function(){if(t||it||st)return;window.scrollY/(document.documentElement.scrollHeight-window.innerHeight)*100>=Qe.showOnScroll&&(t=!0,rt(),e())},{passive:!0}),Qe.showExitIntent&&document.addEventListener("mouseleave",t=>{t.clientY<0&&!at&&!it&&!st&&(ot||(rt(),e()))},{once:!0})}if(!i){const t=T().catch(t=>{console.warn("[Navlens] Experiment init failed:",t);const n=document.getElementById(e);n&&n.remove()});"loading"===document.readyState?document.addEventListener("DOMContentLoaded",async()=>{await t,dt()}):t.then(()=>{dt()})}const ut={lcp:null,cls:0,fid:null,inp:null,fcp:null,ttfb:null};let pt=0,mt=0,ft=null,ht=null,gt=null;function vt(){if(pe)return;pe=!0;const e={type:"web_vitals",timestamp:(new Date).toISOString(),session_id:Ue,page_url:window.location.href,page_path:window.location.pathname,lcp_ms:Math.round(mt),cls:pt.toFixed(4),fid_ms:ft?Math.round(ft):null,inp_ms:ut.inp?Math.round(ut.inp):null,fcp_ms:ht?Math.round(ht):null,ttfb_ms:gt?Math.round(gt):null};console.log("[Navlens] Sending Web Vitals:",e);try{const t=B(e);ae(r,t,!1)}catch(e){console.warn("[Navlens] Failed to send Web Vitals:",e)}}function wt(){try{if("PerformanceObserver"in window){try{new PerformanceObserver(e=>{const t=e.getEntries();if(t.length>0){const e=t[t.length-1];mt=e.startTime,ut.lcp=mt}}).observe({type:"largest-contentful-paint",buffered:!0})}catch(e){}try{new PerformanceObserver(e=>{for(const t of e.getEntries())t.hadRecentInput||(pt+=t.value,ut.cls=pt)}).observe({type:"layout-shift",buffered:!0})}catch(e){}try{new PerformanceObserver(e=>{const t=e.getEntries();t.length>0&&null===ft&&(ft=t[0].processingStart-t[0].startTime,ut.fid=ft)}).observe({type:"first-input",buffered:!0})}catch(e){}try{let e=0;new PerformanceObserver(t=>{for(const n of t.getEntries()){const t=n.duration;t>e&&(e=t,ut.inp=e)}}).observe({type:"event",buffered:!0,durationThreshold:16})}catch(e){}}try{const e=performance.getEntriesByType("paint").find(e=>"first-contentful-paint"===e.name);e&&(ht=e.startTime,ut.fcp=ht)}catch(e){}try{const e=performance.getEntriesByType("navigation")[0];e&&(gt=e.responseStart-e.requestStart,ut.ttfb=gt)}catch(e){}window.addEventListener("visibilitychange",()=>{"hidden"===document.visibilityState&&vt()}),window.addEventListener("pagehide",vt),setTimeout(vt,1e4)}catch(e){console.warn("[Navlens] Web Vitals initialization failed:",e)}}i||("complete"===document.readyState?wt():window.addEventListener("load",wt)),console.log("[Navlens] Tracker initialized. Use navlens.track() for custom events.")}();